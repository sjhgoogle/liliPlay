<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Face Landmark Debug</title>
    <style>
      body {
        background: #111;
      }
      canvas {
        border: 1px solid #444;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>

    <script>
      const img = new Image();
      img.src = "an2.jpg";

      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      const faceMesh = new FaceMesh({
        locateFile: (f) =>
          `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${f}`,
      });

      faceMesh.setOptions({
        maxNumFaces: 1,
        refineLandmarks: true,
      });

      img.onload = async () => {
        canvas.width = img.width;
        canvas.height = img.height;
        await faceMesh.send({ image: img });
      };

      faceMesh.onResults((res) => {
        ctx.drawImage(img, 0, 0);

        if (!res.multiFaceLandmarks) {
          console.log("NO FACE DETECTED");
          return;
        }

        const lm = res.multiFaceLandmarks[0];

        // draw all landmarks
        for (let i = 0; i < lm.length; i++) {
          const p = lm[i];
          const x = p.x * canvas.width;
          const y = p.y * canvas.height;

          ctx.fillStyle = "rgba(0,255,255,0.6)";
          ctx.fillRect(x, y, 2, 2);
        }

        // highlight mouth landmarks
        const mouth = [13, 14, 78, 308];
        ctx.fillStyle = "red";
        mouth.forEach((i) => {
          const p = lm[i];
          ctx.fillRect(p.x * canvas.width, p.y * canvas.height, 5, 5);
        });

        // highlight eyes
        const eyes = [33, 133, 362, 263];
        ctx.fillStyle = "yellow";
        eyes.forEach((i) => {
          const p = lm[i];
          ctx.fillRect(p.x * canvas.width, p.y * canvas.height, 5, 5);
        });

        // nose
        const nose = lm[1];
        ctx.fillStyle = "lime";
        ctx.fillRect(nose.x * canvas.width, nose.y * canvas.height, 8, 8);

        console.log("Face detected");
      });
    </script>
  </body>
</html>
